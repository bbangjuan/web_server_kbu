<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ììœ¨ì£¼í–‰ vs ìˆ˜ë™ì¡°ì‘ ê²Œì„ - AIì¹´</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 20px;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
        }
        
        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: #2563eb;
        }
        
        .back-link {
            color: #2563eb;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .back-link:hover {
            transform: translateX(-5px);
        }
        
        .game-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            max-width: 1500px;
            margin: 0 auto;
            width: 100%;
            overflow-x: auto;
        }
        
        .game-title {
            font-size: 2.5rem;
            color: white;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .game-description {
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 40px;
            text-align: center;
            font-size: 1.1rem;
            max-width: 600px;
        }
        
        .game-board {
            width: 100%;
            max-width: 1400px;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        
        .mode-selection {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .mode-card {
            text-align: center;
            padding: 30px;
            border: 3px solid #e5e7eb;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .mode-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .mode-card.selected {
            border-color: #2563eb;
            background: #f0f9ff;
        }
        
        .mode-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }
        
        .mode-label {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: #1e293b;
        }
        
        .mode-description {
            color: #64748b;
            font-size: 0.95rem;
            line-height: 1.6;
        }
        
        .controls {
            margin-top: 30px;
            text-align: center;
        }
        
        .btn {
            padding: 15px 40px;
            font-size: 1.1rem;
            font-weight: 600;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.5);
        }
        
        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .btn-secondary {
            background: #e5e7eb;
            color: #374151;
        }
        
        .btn-secondary:hover {
            background: #d1d5db;
        }
        
        .game-area {
            display: none;
            margin-top: 30px;
            width: 100%;
        }
        
        .road-container {
            position: relative;
            width: 100%;
            max-width: 1200px;
            height: 200px;
            background: #2d2d2d;
            border-radius: 10px;
            overflow: hidden;
            margin: 0 auto;
        }
        
        .road {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                90deg,
                #3a3a3a 0px 2px,
                #2d2d2d 2px 4px
            );
        }
        
        .lane-divider {
            position: absolute;
            width: 100%;
            height: 2px;
            background: #ffd700;
        }
        
        .lane-divider-1 { top: 33.33%; }
        .lane-divider-2 { top: 66.66%; }
        
        .lane-center {
            position: absolute;
            width: 100%;
            height: 1px;
            background: rgba(255, 215, 0, 0.3);
        }
        
        .lane-center-1 { top: 16.66%; }
        .lane-center-2 { top: 50%; }
        .lane-center-3 { top: 83.33%; }
        
        .finish-line {
            position: absolute;
            right: 0;
            top: 0;
            width: 4px;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                #ffffff 0px 10px,
                #000000 10px 20px
            );
            z-index: 15;
        }
        
        .car {
            position: absolute;
            font-size: 1.5rem;
            transition: all 0.2s ease;
            z-index: 10;
            width: 30px;
            height: 30px;
        }
        
        .obstacle-car {
            position: absolute;
            font-size: 1.2rem;
            z-index: 5;
            width: 30px;
            height: 30px;
        }
        
        .game-info {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 30px;
            padding-top: 30px;
            border-top: 2px solid #e5e7eb;
        }
        
        .info-item {
            background: #f8fafc;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }
        
        .info-label {
            font-size: 0.9rem;
            color: #64748b;
            margin-bottom: 10px;
        }
        
        .info-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #2563eb;
        }
        
        .result-message {
            text-align: center;
            font-size: 1.3rem;
            font-weight: 700;
            margin-top: 20px;
            padding: 20px;
            border-radius: 15px;
            background: #f8fafc;
        }
        
        .result-win {
            background: #d1fae5;
            color: #059669;
        }
        
        .result-lose {
            background: #fee2e2;
            color: #dc2626;
        }
        
        .instructions {
            background: #f0f9ff;
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            border-left: 4px solid #2563eb;
        }
        
        .instructions h3 {
            margin-top: 0;
            color: #1e293b;
        }
        
        .instructions p {
            margin-bottom: 10px;
            color: #475569;
        }
        
        .lane-indicator {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        
        .lane-btn {
            padding: 10px 20px;
            background: #e5e7eb;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        
        @media (max-width: 1200px) {
            .game-board {
                max-width: 100%;
                margin: 0 10px;
            }
            
            .road-container {
                width: 1200px;
                min-width: 1200px;
            }
        }
        
        @media (max-width: 768px) {
            .game-title {
                font-size: 2rem;
            }
            
            .mode-selection {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .road-container {
                width: 800px;
                min-width: 800px;
                height: 150px;
            }
            
            .game-info {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">ğŸï¸ AIì¹´ ë ˆì´ì‹±</div>
            <a href="index.html" class="back-link">â† ë©”ì¸ìœ¼ë¡œ</a>
        </div>
    </nav>

    <div class="game-container">
        <h1 class="game-title">ììœ¨ì£¼í–‰ vs ìˆ˜ë™ì¡°ì‘ ë ˆì´ì‹±</h1>
        <p class="game-description">
            3ì°¨ì„  ë„ë¡œì—ì„œ ë‹¤ë¥¸ ìë™ì°¨ë“¤ì„ í”¼í•˜ë©°<br>
            ëª©í‘œ ì§€ì ê¹Œì§€ ë„ë‹¬í•˜ì„¸ìš”!
        </p>

        <div class="game-board">
            <div class="mode-selection">
                <div class="mode-card" data-mode="autonomous">
                    <div class="mode-icon">ğŸ¤–</div>
                    <div class="mode-label">ììœ¨ì£¼í–‰</div>
                    <div class="mode-description">
                        AIê°€ ìë™ìœ¼ë¡œ ì°¨ì„ ì„ ë³€ê²½í•˜ë©°<br>
                        ë‹¤ë¥¸ ìë™ì°¨ë¥¼ í”¼í•´ ëª©í‘œê¹Œì§€ ì´ë™í•©ë‹ˆë‹¤.
                    </div>
                </div>

                <div class="mode-card" data-mode="manual">
                    <div class="mode-icon">ğŸ‘¤</div>
                    <div class="mode-label">ìˆ˜ë™ì¡°ì‘</div>
                    <div class="mode-description">
                        A/D í‚¤ë¡œ ì°¨ì„ ì„ ë³€ê²½í•˜ë©°<br>
                        ë‹¤ë¥¸ ìë™ì°¨ë¥¼ í”¼í•´ ëª©í‘œê¹Œì§€ ì´ë™í•©ë‹ˆë‹¤.
                    </div>
                </div>
            </div>

            <div class="controls">
                <button class="btn btn-primary" onclick="startGame()" id="startBtn">ê²Œì„ ì‹œì‘</button>
                <button class="btn btn-secondary" onclick="resetGame()" id="resetBtn" style="display: none;">ë‹¤ì‹œ ì‹œì‘</button>
            </div>

            <div class="game-area" id="gameArea">
                    <div class="road-wrapper">
                        <div class="road-container">
                            <div class="road">
                                <div class="lane-center lane-center-1"></div>
                                <div class="lane-center lane-center-2"></div>
                                <div class="lane-center lane-center-3"></div>
                                <div class="lane-divider lane-divider-1"></div>
                                <div class="lane-divider lane-divider-2"></div>
                                <div class="finish-line"></div>
                            </div>
                            <div class="car" id="car">ğŸï¸</div>
                            <div id="obstacles"></div>
                        </div>
                    </div>
                
                <div class="lane-indicator" id="laneIndicator" style="display: none;">
                    <button class="lane-btn" onclick="changeLane(0)">1ì°¨ì„ </button>
                    <button class="lane-btn active" onclick="changeLane(1)">2ì°¨ì„ </button>
                    <button class="lane-btn" onclick="changeLane(2)">3ì°¨ì„ </button>
                </div>
                
                <div class="game-info">
                    <div class="info-item">
                        <div class="info-label">ì§„í–‰ë¥ </div>
                        <div class="info-value" id="progress">0%</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">ì‹œê°„</div>
                        <div class="info-value" id="time">0ì´ˆ</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">í˜„ì¬ ì°¨ì„ </div>
                        <div class="info-value" id="currentLane">2ì°¨ì„ </div>
                    </div>
                </div>
                
                <div class="instructions" id="instructions">
                    <h3>ê²Œì„ ë°©ë²•</h3>
                    <p id="instructionText">ëª¨ë“œë¥¼ ì„ íƒí•˜ê³  ê²Œì„ì„ ì‹œì‘í•˜ì„¸ìš”!</p>
                </div>
            </div>

            <div id="result" style="display: none;"></div>
        </div>
    </div>

    <script>
        let selectedMode = null;
        let gameStarted = false;
        let carX = 50; // ìë™ì°¨ì˜ X ì¢Œí‘œ
        let currentLane = 1; // í˜„ì¬ ì°¨ì„  (0, 1, 2)
        let progress = 0;
        let time = 0;
        let obstacles = [];
        let gameInterval = null;
        let timeInterval = null;
        let obstacleInterval = null;

        // ì°¨ì„  ìœ„ì¹˜ ê³„ì‚° (ë„ë¡œ ë†’ì´ ê¸°ì¤€)
        const lanePositions = [16.66, 50, 83.33]; // ê° ì°¨ì„ ì˜ ì¤‘ì•™ ìœ„ì¹˜ (%)

        // ëª¨ë“œ ì„ íƒ
        document.querySelectorAll('.mode-card').forEach(card => {
            card.addEventListener('click', () => {
                document.querySelectorAll('.mode-card').forEach(c => c.classList.remove('selected'));
                card.classList.add('selected');
                selectedMode = card.dataset.mode;
                
                const instructionText = document.getElementById('instructionText');
                if (selectedMode === 'autonomous') {
                    instructionText.textContent = 'AIê°€ ìë™ìœ¼ë¡œ ì°¨ì„ ì„ ë³€ê²½í•˜ë©° ë‹¤ë¥¸ ìë™ì°¨ë¥¼ í”¼í•´ ëª©í‘œê¹Œì§€ ì´ë™í•©ë‹ˆë‹¤. ìŠ¤íƒ€íŠ¸ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì‹œì‘í•˜ì„¸ìš”!';
                } else {
                    instructionText.textContent = 'A/D í‚¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¢Œìš° ì°¨ì„ ì„ ë³€ê²½í•˜ë©° ë‹¤ë¥¸ ìë™ì°¨ë¥¼ í”¼í•˜ì„¸ìš”. ìŠ¤íƒ€íŠ¸ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì‹œì‘í•˜ì„¸ìš”!';
                }
            });
        });

        function startGame() {
            if (!selectedMode) {
                alert('ë¨¼ì € ëª¨ë“œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”!');
                return;
            }
            
            gameStarted = true;
            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('resetBtn').style.display = 'inline-block';
            document.getElementById('gameArea').style.display = 'block';
            document.getElementById('laneIndicator').style.display = 'flex';
            
            // ê²Œì„ ì´ˆê¸°í™”
            carX = 30;
            currentLane = 1;
            progress = 0;
            time = 0;
            
            // ìë™ì°¨ ìœ„ì¹˜ ì„¤ì •
            updateCarPosition();
            
            // ì‹œê°„ ì¹´ìš´í„° ì‹œì‘
            timeInterval = setInterval(() => {
                time++;
                document.getElementById('time').textContent = time + 'ì´ˆ';
            }, 1000);
            
            // ì¥ì• ë¬¼ ìƒì„± ì‹œì‘
            startObstacleGeneration();
            
            if (selectedMode === 'autonomous') {
                startAutonomousMode();
            } else {
                startManualMode();
            }
        }

        function startObstacleGeneration() {
            obstacleInterval = setInterval(() => {
                if (obstacles.length < 5) { // ìµœëŒ€ 5ê°œì˜ ì¥ì• ë¬¼
                    generateObstacle();
                }
            }, 1500); // ë” ìì£¼ ìƒì„±
        }

        function generateObstacle() {
            const obstaclesContainer = document.getElementById('obstacles');
            const obstacle = document.createElement('div');
            obstacle.className = 'obstacle-car';
            
            // ë‹¤ì–‘í•œ ìƒ‰ìƒì˜ ìë™ì°¨
            const carColors = ['ğŸš—', 'ğŸš™', 'ğŸš•', 'ğŸš“', 'ğŸš‘', 'ğŸš’', 'ğŸš', 'ğŸšš'];
            obstacle.textContent = carColors[Math.floor(Math.random() * carColors.length)];
            
            // ëœë¤í•œ ì°¨ì„ ì— ë°°ì¹˜
            const randomLane = Math.floor(Math.random() * 3);
            const roadContainer = document.querySelector('.road-container');
            const roadHeight = roadContainer.offsetHeight;
            const roadWidth = roadContainer.offsetWidth;
            
            obstacle.style.left = '100%'; // ì˜¤ë¥¸ìª½ì—ì„œ ì‹œì‘
            obstacle.style.top = (lanePositions[randomLane] / 100 * roadHeight - 15) + 'px'; // ì°¨ëŸ‰ ë†’ì´ì˜ ì ˆë°˜ë§Œí¼ ìœ„ë¡œ ì¡°ì •
            
            obstaclesContainer.appendChild(obstacle);
            
            obstacles.push({
                element: obstacle,
                lane: randomLane,
                x: 100, // ì˜¤ë¥¸ìª½ì—ì„œ ì‹œì‘
                y: lanePositions[randomLane] / 100 * roadHeight - 15,
                pixelX: roadWidth, // ì‹¤ì œ í”½ì…€ ìœ„ì¹˜
                speed: 1 + Math.random() * 2
            });
            
            // ì¥ì• ë¬¼ ìƒì„± ì™„ë£Œ
        }

        function updateCarPosition() {
            const car = document.getElementById('car');
            const roadContainer = document.querySelector('.road-container');
            const roadHeight = roadContainer.offsetHeight;
            const roadWidth = roadContainer.offsetWidth;
            
            // ìë™ì°¨ ìœ„ì¹˜ ì„¤ì • - ì°¨ì„  ì¤‘ì•™ì— ì •í™•íˆ ë°°ì¹˜
            car.style.left = carX + 'px';
            car.style.top = (lanePositions[currentLane] / 100 * roadHeight - 15) + 'px'; // ì°¨ëŸ‰ ë†’ì´ì˜ ì ˆë°˜ë§Œí¼ ìœ„ë¡œ ì¡°ì •
            
            // ì§„í–‰ë¥  ê³„ì‚° (ëª©í‘œ ì§€ì ê¹Œì§€ì˜ ê±°ë¦¬)
            progress = Math.min((carX / (roadWidth - 50)) * 100, 100);
            document.getElementById('progress').textContent = Math.round(progress) + '%';
            document.getElementById('currentLane').textContent = (currentLane + 1) + 'ì°¨ì„ ';
            
            // ì°¨ì„  ë²„íŠ¼ ì—…ë°ì´íŠ¸
            document.querySelectorAll('.lane-btn').forEach((btn, index) => {
                btn.classList.toggle('active', index === currentLane);
            });
            
            // ì¶©ëŒ ê²€ì‚¬ëŠ” ë§¤ í”„ë ˆì„ë§ˆë‹¤ ì‹¤í–‰
            checkCollisions();
            
            // ì™„ì£¼ ê²€ì‚¬ (ëª©í‘œ ì§€ì  ë„ë‹¬)
            if (carX >= roadWidth - 50) {
                endGame(true);
            }
        }

        function checkCollisions() {
            const roadContainer = document.querySelector('.road-container');
            const roadWidth = roadContainer.offsetWidth;
            
            obstacles.forEach((obstacle, index) => {
                // ì¥ì• ë¬¼ì˜ ì‹¤ì œ í”½ì…€ ìœ„ì¹˜ ê³„ì‚°
                const obstaclePixelX = (obstacle.x / 100) * roadWidth;
                
                // ê°™ì€ ì°¨ì„ ì— ìˆê³  ì¶©ëŒ ê±°ë¦¬ ë‚´ì— ìˆìœ¼ë©´ ê²Œì„ ì¢…ë£Œ
                if (obstacle.lane === currentLane) {
                    // ì¶©ëŒ ê°ì§€: ìë™ì°¨ì™€ ì¥ì• ë¬¼ì´ ê²¹ì¹˜ëŠ”ì§€ í™•ì¸
                    const distance = Math.abs(carX - obstaclePixelX);
                    const heightDiff = Math.abs(parseFloat(document.getElementById('car').style.top) - parseFloat(obstacle.element.style.top));
                    
                    // ê±°ë¦¬ê°€ 30px ì´ë‚´ì´ê³  ë†’ì´ ì°¨ì´ê°€ 20px ì´ë‚´ë©´ ì¶©ëŒ
                    if (distance < 30 && heightDiff < 20) {
                        endGame(false);
                        return;
                    }
                }
            });
        }

        function isColliding(rect1, rect2) {
            // ê°„ë‹¨í•œ ì¶©ëŒ ê°ì§€
            return rect1.left < rect2.left + rect2.width &&
                   rect1.left + rect1.width > rect2.left &&
                   rect1.top < rect2.top + rect2.height &&
                   rect1.top + rect1.height > rect2.top;
        }

        function changeLane(newLane) {
            if (!gameStarted || selectedMode !== 'manual') return;
            
            currentLane = newLane;
            updateCarPosition();
        }

        function startAutonomousMode() {
            gameInterval = setInterval(() => {
                carX += 2; // ìë™ìœ¼ë¡œ ì•ìœ¼ë¡œ ì´ë™
                
                // ì•ì— ì¥ì• ë¬¼ì´ ìˆìœ¼ë©´ ì°¨ì„  ë³€ê²½ (ë” ì •í™•í•œ ê°ì§€)
                const roadContainer = document.querySelector('.road-container');
                const roadWidth = roadContainer.offsetWidth;
                
                const obstacleInCurrentLane = obstacles.some(obstacle => {
                    const obstaclePixelX = (obstacle.x / 100) * roadWidth;
                    
                    return obstacle.lane === currentLane && 
                           obstaclePixelX < carX + 60 && // ì•ìª½ 60px ì´ë‚´
                           obstaclePixelX > carX - 20;   // ë’¤ìª½ 20px ì´ë‚´
                });
                
                if (obstacleInCurrentLane) {
                    // ë‹¤ë¥¸ ì°¨ì„ ìœ¼ë¡œ ì´ë™
                    const availableLanes = [0, 1, 2].filter(lane => 
                        lane !== currentLane && !obstacles.some(obstacle => {
                            const obstaclePixelX = (obstacle.x / 100) * roadWidth;
                            
                            return obstacle.lane === lane && 
                                   obstaclePixelX < carX + 60 && 
                                   obstaclePixelX > carX - 20;
                        })
                    );
                    
                    if (availableLanes.length > 0) {
                        currentLane = availableLanes[Math.floor(Math.random() * availableLanes.length)];
                    }
                }
                
                updateCarPosition();
            }, 50);
        }

        function startManualMode() {
            // ìˆ˜ë™ ëª¨ë“œì—ì„œë„ ìë™ì°¨ê°€ ì•ìœ¼ë¡œ ì´ë™
            gameInterval = setInterval(() => {
                carX += 1.5; // ìˆ˜ë™ ëª¨ë“œëŠ” ì¡°ê¸ˆ ëŠë¦¬ê²Œ
                updateCarPosition();
            }, 50);
        }

        function endGame(success) {
            clearInterval(gameInterval);
            clearInterval(timeInterval);
            clearInterval(obstacleInterval);
            gameStarted = false;
            
            const resultDiv = document.getElementById('result');
            resultDiv.style.display = 'block';
            
            if (success) {
                resultDiv.className = 'result-message result-win';
                resultDiv.innerHTML = `ğŸ‰ ëª©í‘œ ë„ë‹¬ ì„±ê³µ!<br>ì‹œê°„: ${time}ì´ˆ`;
            } else {
                resultDiv.className = 'result-message result-lose';
                resultDiv.innerHTML = `ğŸ’¥ ì¶©ëŒë¡œ ê²Œì„ ì¢…ë£Œ!<br>ì‹œê°„: ${time}ì´ˆ`;
            }
        }

        function resetGame() {
            gameStarted = false;
            clearInterval(gameInterval);
            clearInterval(timeInterval);
            clearInterval(obstacleInterval);
            
            document.getElementById('startBtn').style.display = 'inline-block';
            document.getElementById('resetBtn').style.display = 'none';
            document.getElementById('gameArea').style.display = 'none';
            document.getElementById('laneIndicator').style.display = 'none';
            document.getElementById('result').style.display = 'none';
            
            // ì¥ì• ë¬¼ ì œê±°
            document.getElementById('obstacles').innerHTML = '';
            obstacles = [];
            
            carX = 30;
            currentLane = 1;
            progress = 0;
            time = 0;
        }

        // í‚¤ë³´ë“œ ì´ë²¤íŠ¸ (ìˆ˜ë™ ëª¨ë“œìš©)
        document.addEventListener('keydown', (e) => {
            if (!gameStarted || selectedMode !== 'manual') return;
            
            if (e.key === 'a' || e.key === 'A') {
                if (currentLane > 0) {
                    changeLane(currentLane - 1);
                }
            } else if (e.key === 'd' || e.key === 'D') {
                if (currentLane < 2) {
                    changeLane(currentLane + 1);
                }
            }
        });

        // í„°ì¹˜ ì´ë²¤íŠ¸ (ëª¨ë°”ì¼ìš©)
        let touchStartX = 0;
        let touchEndX = 0;

        document.addEventListener('touchstart', (e) => {
            if (!gameStarted || selectedMode !== 'manual') return;
            touchStartX = e.changedTouches[0].screenX;
        });

        document.addEventListener('touchend', (e) => {
            if (!gameStarted || selectedMode !== 'manual') return;
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        });

        function handleSwipe() {
            if (Math.abs(touchStartX - touchEndX) > 50) {
                if (touchStartX > touchEndX && currentLane < 2) {
                    changeLane(currentLane + 1); // ì˜¤ë¥¸ìª½ ìŠ¤ì™€ì´í”„
                } else if (touchStartX < touchEndX && currentLane > 0) {
                    changeLane(currentLane - 1); // ì™¼ìª½ ìŠ¤ì™€ì´í”„
                }
            }
        }

        // ì¥ì• ë¬¼ ì´ë™
        setInterval(() => {
            if (!gameStarted) return; // ê²Œì„ì´ ì‹œì‘ë˜ì§€ ì•Šì•˜ìœ¼ë©´ ì‹¤í–‰í•˜ì§€ ì•ŠìŒ
            
            obstacles.forEach((obstacle, index) => {
                obstacle.x -= obstacle.speed;
                obstacle.element.style.left = obstacle.x + '%';
                
                // ì¥ì• ë¬¼ì˜ ì‹¤ì œ í”½ì…€ ìœ„ì¹˜ ì—…ë°ì´íŠ¸
                const roadContainer = document.querySelector('.road-container');
                const roadWidth = roadContainer.offsetWidth;
                obstacle.pixelX = (obstacle.x / 100) * roadWidth;
                
                // í™”ë©´ ë°–ìœ¼ë¡œ ë‚˜ê°€ë©´ ì œê±°
                if (obstacle.x < -10) {
                    obstacle.element.remove();
                    obstacles.splice(index, 1);
                }
            });
        }, 50);
    </script>
</body>
</html>
