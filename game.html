<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÏûêÏú®Ï£ºÌñâ vs ÏàòÎèôÏ°∞Ïûë Í≤åÏûÑ - AIÏπ¥</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 20px;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
        }
        
        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: #2563eb;
        }
        
        .back-link {
            color: #2563eb;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .back-link:hover {
            transform: translateX(-5px);
        }
        
        .game-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            max-width: 1500px;
            margin: 0 auto;
            width: 100%;
            overflow-x: auto;
        }
        
        .game-title {
            font-size: 2.5rem;
            color: white;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .game-description {
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 40px;
            text-align: center;
            font-size: 1.1rem;
            max-width: 600px;
        }
        
        .game-board {
            width: 100%;
            max-width: 1400px;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        
        .mode-selection {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .mode-card {
            text-align: center;
            padding: 30px;
            border: 3px solid #e5e7eb;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .mode-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .mode-card.selected {
            border-color: #2563eb;
            background: #f0f9ff;
        }
        
        .mode-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }
        
        .mode-label {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: #1e293b;
        }
        
        .mode-description {
            color: #64748b;
            font-size: 0.95rem;
            line-height: 1.6;
        }
        
        .controls {
            margin-top: 30px;
            text-align: center;
        }
        
        .btn {
            padding: 15px 40px;
            font-size: 1.1rem;
            font-weight: 600;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.5);
        }
        
        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .btn-secondary {
            background: #e5e7eb;
            color: #374151;
        }
        
        .btn-secondary:hover {
            background: #d1d5db;
        }
        
        .game-area {
            display: none;
            margin-top: 30px;
            width: 100%;
        }
        
        .road-container {
            position: relative;
            width: 100%;
            max-width: 1200px;
            height: 200px;
            background: #2d2d2d;
            border-radius: 10px;
            overflow: hidden;
            margin: 0 auto;
        }
        
        .road {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                90deg,
                #3a3a3a 0px 2px,
                #2d2d2d 2px 4px
            );
        }
        
        .lane-divider {
            position: absolute;
            width: 100%;
            height: 2px;
            background: #ffd700;
        }
        
        .lane-divider-1 { top: 33.33%; }
        .lane-divider-2 { top: 66.66%; }
        
        .lane-center {
            position: absolute;
            width: 100%;
            height: 1px;
            background: rgba(255, 215, 0, 0.3);
        }
        
        .lane-center-1 { top: 16.66%; }
        .lane-center-2 { top: 50%; }
        .lane-center-3 { top: 83.33%; }
        
        .finish-line {
            position: absolute;
            right: 0;
            top: 0;
            width: 4px;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                #ffffff 0px 10px,
                #000000 10px 20px
            );
            z-index: 15;
        }
        
        .car {
            position: absolute;
            font-size: 1.5rem;
            transition: all 0.2s ease;
            z-index: 10;
            width: 30px;
            height: 30px;
        }
        
        .obstacle-car {
            position: absolute;
            font-size: 1.2rem;
            z-index: 5;
            width: 30px;
            height: 30px;
        }
        
        .game-info {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 30px;
            padding-top: 30px;
            border-top: 2px solid #e5e7eb;
        }
        
        .info-item {
            background: #f8fafc;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }
        
        .info-label {
            font-size: 0.9rem;
            color: #64748b;
            margin-bottom: 10px;
        }
        
        .info-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #2563eb;
        }
        
        .result-message {
            text-align: center;
            font-size: 1.3rem;
            font-weight: 700;
            margin-top: 20px;
            padding: 20px;
            border-radius: 15px;
            background: #f8fafc;
        }
        
        .result-win {
            background: #d1fae5;
            color: #059669;
        }
        
        .result-lose {
            background: #fee2e2;
            color: #dc2626;
        }
        
        .instructions {
            background: #f0f9ff;
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            border-left: 4px solid #2563eb;
        }
        
        .instructions h3 {
            margin-top: 0;
            color: #1e293b;
        }
        
        .instructions p {
            margin-bottom: 10px;
            color: #475569;
        }
        
        .lane-indicator {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        
        .lane-btn {
            padding: 10px 20px;
            background: #e5e7eb;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        
        @media (max-width: 1200px) {
            .game-board {
                max-width: 100%;
                margin: 0 10px;
            }
            
            .road-container {
                width: 1200px;
                min-width: 1200px;
            }
        }
        
        @media (max-width: 768px) {
            .game-title {
                font-size: 2rem;
            }
            
            .mode-selection {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .road-container {
                width: 800px;
                min-width: 800px;
                height: 150px;
            }
            
            .game-info {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">üèéÔ∏è AIÏπ¥ Î†àÏù¥Ïã±</div>
            <a href="index.html" class="back-link">‚Üê Î©îÏù∏ÏúºÎ°ú</a>
        </div>
    </nav>

    <div class="game-container">
        <h1 class="game-title">ÏûêÏú®Ï£ºÌñâ vs ÏàòÎèôÏ°∞Ïûë Î†àÏù¥Ïã±</h1>
        <p class="game-description">
            3Ï∞®ÏÑ† ÎèÑÎ°úÏóêÏÑú Îã§Î•∏ ÏûêÎèôÏ∞®Îì§ÏùÑ ÌîºÌïòÎ©∞<br>
            Î™©Ìëú ÏßÄÏ†êÍπåÏßÄ ÎèÑÎã¨ÌïòÏÑ∏Ïöî!
        </p>

        <div class="game-board">
            <div class="mode-selection">
                <div class="mode-card" data-mode="autonomous">
                    <div class="mode-icon">ü§ñ</div>
                    <div class="mode-label">ÏûêÏú®Ï£ºÌñâ</div>
                    <div class="mode-description">
                        AIÍ∞Ä ÏûêÎèôÏúºÎ°ú Ï∞®ÏÑ†ÏùÑ Î≥ÄÍ≤ΩÌïòÎ©∞<br>
                        Îã§Î•∏ ÏûêÎèôÏ∞®Î•º ÌîºÌï¥ Î™©ÌëúÍπåÏßÄ Ïù¥ÎèôÌï©ÎãàÎã§.
                    </div>
                </div>

                <div class="mode-card" data-mode="manual">
                    <div class="mode-icon">üë§</div>
                    <div class="mode-label">ÏàòÎèôÏ°∞Ïûë</div>
                    <div class="mode-description">
                        A/D ÌÇ§Î°ú Ï∞®ÏÑ†ÏùÑ Î≥ÄÍ≤ΩÌïòÎ©∞<br>
                        Îã§Î•∏ ÏûêÎèôÏ∞®Î•º ÌîºÌï¥ Î™©ÌëúÍπåÏßÄ Ïù¥ÎèôÌï©ÎãàÎã§.
                    </div>
                </div>
            </div>

            <div class="controls">
                <button class="btn btn-primary" onclick="startGame()" id="startBtn">Í≤åÏûÑ ÏãúÏûë</button>
                <button class="btn btn-secondary" onclick="resetGame()" id="resetBtn" style="display: none;">Îã§Ïãú ÏãúÏûë</button>
            </div>

            <div class="game-area" id="gameArea">
                    <div class="road-wrapper">
                        <div class="road-container">
                            <div class="road">
                                <div class="lane-center lane-center-1"></div>
                                <div class="lane-center lane-center-2"></div>
                                <div class="lane-center lane-center-3"></div>
                                <div class="lane-divider lane-divider-1"></div>
                                <div class="lane-divider lane-divider-2"></div>
                                <div class="finish-line"></div>
                            </div>
                            <div class="car" id="car">üèéÔ∏è</div>
                            <div id="obstacles"></div>
                        </div>
                    </div>
                
                <div class="lane-indicator" id="laneIndicator" style="display: none;">
                    <button class="lane-btn" onclick="changeLane(0)">1Ï∞®ÏÑ†</button>
                    <button class="lane-btn active" onclick="changeLane(1)">2Ï∞®ÏÑ†</button>
                    <button class="lane-btn" onclick="changeLane(2)">3Ï∞®ÏÑ†</button>
                </div>
                
                <div class="game-info">
                    <div class="info-item">
                        <div class="info-label">ÏßÑÌñâÎ•†</div>
                        <div class="info-value" id="progress">0%</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">ÏãúÍ∞Ñ</div>
                        <div class="info-value" id="time">0Ï¥à</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">ÌòÑÏû¨ Ï∞®ÏÑ†</div>
                        <div class="info-value" id="currentLane">2Ï∞®ÏÑ†</div>
                    </div>
                </div>
                
                <div class="instructions" id="instructions">
                    <h3>Í≤åÏûÑ Î∞©Î≤ï</h3>
                    <p id="instructionText">Î™®ÎìúÎ•º ÏÑ†ÌÉùÌïòÍ≥† Í≤åÏûÑÏùÑ ÏãúÏûëÌïòÏÑ∏Ïöî!</p>
                </div>
            </div>

            <div id="result" style="display: none;"></div>
        </div>
    </div>

    <script>
        let selectedMode = null;
        let gameStarted = false;
        let carX = 50; // ÏûêÎèôÏ∞®Ïùò X Ï¢åÌëú
        let currentLane = 1; // ÌòÑÏû¨ Ï∞®ÏÑ† (0, 1, 2)
        let progress = 0;
        let time = 0;
        let obstacles = [];
        let gameInterval = null;
        let timeInterval = null;
        let obstacleInterval = null;

        // Ï∞®ÏÑ† ÏúÑÏπò Í≥ÑÏÇ∞ (ÎèÑÎ°ú ÎÜíÏù¥ Í∏∞Ï§Ä)
        const lanePositions = [16.66, 50, 83.33]; // Í∞Å Ï∞®ÏÑ†Ïùò Ï§ëÏïô ÏúÑÏπò (%)

        // Î™®Îìú ÏÑ†ÌÉù
        document.querySelectorAll('.mode-card').forEach(card => {
            card.addEventListener('click', () => {
                document.querySelectorAll('.mode-card').forEach(c => c.classList.remove('selected'));
                card.classList.add('selected');
                selectedMode = card.dataset.mode;
                
                const instructionText = document.getElementById('instructionText');
                if (selectedMode === 'autonomous') {
                    instructionText.textContent = 'AIÍ∞Ä ÏûêÎèôÏúºÎ°ú Ï∞®ÏÑ†ÏùÑ Î≥ÄÍ≤ΩÌïòÎ©∞ Îã§Î•∏ ÏûêÎèôÏ∞®Î•º ÌîºÌï¥ Î™©ÌëúÍπåÏßÄ Ïù¥ÎèôÌï©ÎãàÎã§. Ïä§ÌÉÄÌä∏ Î≤ÑÌäºÏùÑ ÎàåÎü¨ ÏãúÏûëÌïòÏÑ∏Ïöî!';
                } else {
                    instructionText.textContent = 'A/D ÌÇ§Î•º ÏÇ¨Ïö©ÌïòÏó¨ Ï¢åÏö∞ Ï∞®ÏÑ†ÏùÑ Î≥ÄÍ≤ΩÌïòÎ©∞ Îã§Î•∏ ÏûêÎèôÏ∞®Î•º ÌîºÌïòÏÑ∏Ïöî. Ïä§ÌÉÄÌä∏ Î≤ÑÌäºÏùÑ ÎàåÎü¨ ÏãúÏûëÌïòÏÑ∏Ïöî!';
                }
            });
        });

        function startGame() {
            if (!selectedMode) {
                alert('Î®ºÏ†Ä Î™®ÎìúÎ•º ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî!');
                return;
            }
            
            gameStarted = true;
            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('resetBtn').style.display = 'inline-block';
            document.getElementById('gameArea').style.display = 'block';
            document.getElementById('laneIndicator').style.display = 'flex';
            
            // Í≤åÏûÑ Ï¥àÍ∏∞Ìôî
            carX = 30;
            currentLane = 1;
            progress = 0;
            time = 0;
            
            // ÏûêÎèôÏ∞® ÏúÑÏπò ÏÑ§Ï†ï
            updateCarPosition();
            
            // ÏãúÍ∞Ñ Ïπ¥Ïö¥ÌÑ∞ ÏãúÏûë
            timeInterval = setInterval(() => {
                time++;
                document.getElementById('time').textContent = time + 'Ï¥à';
            }, 1000);
            
            // Ïû•Ïï†Î¨º ÏÉùÏÑ± ÏãúÏûë
            startObstacleGeneration();
            
            if (selectedMode === 'autonomous') {
                startAutonomousMode();
            } else {
                startManualMode();
            }
        }

        function startObstacleGeneration() {
            obstacleInterval = setInterval(() => {
                if (obstacles.length < 5) { // ÏµúÎåÄ 5Í∞úÏùò Ïû•Ïï†Î¨º
                    generateObstacle();
                }
            }, 1500); // Îçî ÏûêÏ£º ÏÉùÏÑ±
        }

        function generateObstacle() {
            const obstaclesContainer = document.getElementById('obstacles');
            const obstacle = document.createElement('div');
            obstacle.className = 'obstacle-car';
            
            // Îã§ÏñëÌïú ÏÉâÏÉÅÏùò ÏûêÎèôÏ∞®
            const carColors = ['üöó', 'üöô', 'üöï', 'üöì', 'üöë', 'üöí', 'üöê', 'üöö'];
            obstacle.textContent = carColors[Math.floor(Math.random() * carColors.length)];
            
            // ÎûúÎç§Ìïú Ï∞®ÏÑ†Ïóê Î∞∞Ïπò
            const randomLane = Math.floor(Math.random() * 3);
            const roadContainer = document.querySelector('.road-container');
            const roadHeight = roadContainer.offsetHeight;
            const roadWidth = roadContainer.offsetWidth;
            
            obstacle.style.left = '100%'; // Ïò§Î•∏Ï™ΩÏóêÏÑú ÏãúÏûë
            obstacle.style.top = (lanePositions[randomLane] / 100 * roadHeight - 15) + 'px'; // Ï∞®Îüâ ÎÜíÏù¥Ïùò Ï†àÎ∞òÎßåÌÅº ÏúÑÎ°ú Ï°∞Ï†ï
            
            obstaclesContainer.appendChild(obstacle);
            
            obstacles.push({
                element: obstacle,
                lane: randomLane,
                x: 100, // Ïò§Î•∏Ï™ΩÏóêÏÑú ÏãúÏûë
                y: lanePositions[randomLane] / 100 * roadHeight - 15,
                pixelX: roadWidth, // Ïã§Ï†ú ÌîΩÏÖÄ ÏúÑÏπò
                speed: 1 + Math.random() * 2
            });
            
            // Ïû•Ïï†Î¨º ÏÉùÏÑ± ÏôÑÎ£å
        }

        function updateCarPosition() {
            const car = document.getElementById('car');
            const roadContainer = document.querySelector('.road-container');
            const roadHeight = roadContainer.offsetHeight;
            const roadWidth = roadContainer.offsetWidth;
            
            // ÏûêÎèôÏ∞® ÏúÑÏπò ÏÑ§Ï†ï - Ï∞®ÏÑ† Ï§ëÏïôÏóê Ï†ïÌôïÌûà Î∞∞Ïπò
            car.style.left = carX + 'px';
            car.style.top = (lanePositions[currentLane] / 100 * roadHeight - 15) + 'px'; // Ï∞®Îüâ ÎÜíÏù¥Ïùò Ï†àÎ∞òÎßåÌÅº ÏúÑÎ°ú Ï°∞Ï†ï
            
            // ÏßÑÌñâÎ•† Í≥ÑÏÇ∞ (Î™©Ìëú ÏßÄÏ†êÍπåÏßÄÏùò Í±∞Î¶¨)
            progress = Math.min((carX / (roadWidth - 50)) * 100, 100);
            document.getElementById('progress').textContent = Math.round(progress) + '%';
            document.getElementById('currentLane').textContent = (currentLane + 1) + 'Ï∞®ÏÑ†';
            
            // Ï∞®ÏÑ† Î≤ÑÌäº ÏóÖÎç∞Ïù¥Ìä∏
            document.querySelectorAll('.lane-btn').forEach((btn, index) => {
                btn.classList.toggle('active', index === currentLane);
            });
            
            // Ï∂©Îèå Í≤ÄÏÇ¨Îäî Îß§ ÌîÑÎ†àÏûÑÎßàÎã§ Ïã§Ìñâ
            checkCollisions();
            
            // ÏôÑÏ£º Í≤ÄÏÇ¨ (Î™©Ìëú ÏßÄÏ†ê ÎèÑÎã¨)
            if (carX >= roadWidth - 50) {
                endGame(true);
            }
        }

        function checkCollisions() {
            const roadContainer = document.querySelector('.road-container');
            const roadWidth = roadContainer.offsetWidth;
            
            obstacles.forEach((obstacle, index) => {
                // Ïû•Ïï†Î¨ºÏùò Ïã§Ï†ú ÌîΩÏÖÄ ÏúÑÏπò Í≥ÑÏÇ∞
                const obstaclePixelX = (obstacle.x / 100) * roadWidth;
                
                // Í∞ôÏùÄ Ï∞®ÏÑ†Ïóê ÏûàÍ≥† Ï∂©Îèå Í±∞Î¶¨ ÎÇ¥Ïóê ÏûàÏúºÎ©¥ Í≤åÏûÑ Ï¢ÖÎ£å
                if (obstacle.lane === currentLane) {
                    // Ï∂©Îèå Í∞êÏßÄ: ÏûêÎèôÏ∞®ÏôÄ Ïû•Ïï†Î¨ºÏù¥ Í≤πÏπòÎäîÏßÄ ÌôïÏù∏
                    const distance = Math.abs(carX - obstaclePixelX);
                    const heightDiff = Math.abs(parseFloat(document.getElementById('car').style.top) - parseFloat(obstacle.element.style.top));
                    
                    // Í±∞Î¶¨Í∞Ä 30px Ïù¥ÎÇ¥Ïù¥Í≥† ÎÜíÏù¥ Ï∞®Ïù¥Í∞Ä 20px Ïù¥ÎÇ¥Î©¥ Ï∂©Îèå
                    if (distance < 30 && heightDiff < 20) {
                        endGame(false);
                        return;
                    }
                }
            });
        }

        function isColliding(rect1, rect2) {
            // Í∞ÑÎã®Ìïú Ï∂©Îèå Í∞êÏßÄ
            return rect1.left < rect2.left + rect2.width &&
                   rect1.left + rect1.width > rect2.left &&
                   rect1.top < rect2.top + rect2.height &&
                   rect1.top + rect1.height > rect2.top;
        }

        function changeLane(newLane) {
            if (!gameStarted || selectedMode !== 'manual') return;
            
            currentLane = newLane;
            updateCarPosition();
        }

        function startAutonomousMode() {
            gameInterval = setInterval(() => {
                carX += 2; // ÏûêÎèôÏúºÎ°ú ÏïûÏúºÎ°ú Ïù¥Îèô
                
                // ÏïûÏóê Ïû•Ïï†Î¨ºÏù¥ ÏûàÏúºÎ©¥ Ï∞®ÏÑ† Î≥ÄÍ≤Ω (Îçî Ï†ïÌôïÌïú Í∞êÏßÄ)
                const roadContainer = document.querySelector('.road-container');
                const roadWidth = roadContainer.offsetWidth;
                
                const obstacleInCurrentLane = obstacles.some(obstacle => {
                    const obstaclePixelX = (obstacle.x / 100) * roadWidth;
                    
                    return obstacle.lane === currentLane && 
                           obstaclePixelX < carX + 60 && // ÏïûÏ™Ω 60px Ïù¥ÎÇ¥
                           obstaclePixelX > carX - 20;   // Îí§Ï™Ω 20px Ïù¥ÎÇ¥
                });
                
                if (obstacleInCurrentLane) {
                    // Îã§Î•∏ Ï∞®ÏÑ†ÏúºÎ°ú Ïù¥Îèô
                    const availableLanes = [0, 1, 2].filter(lane => 
                        lane !== currentLane && !obstacles.some(obstacle => {
                            const obstaclePixelX = (obstacle.x / 100) * roadWidth;
                            
                            return obstacle.lane === lane && 
                                   obstaclePixelX < carX + 60 && 
                                   obstaclePixelX > carX - 20;
                        })
                    );
                    
                    if (availableLanes.length > 0) {
                        currentLane = availableLanes[Math.floor(Math.random() * availableLanes.length)];
                    }
                }
                
                updateCarPosition();
            }, 50);
        }

        function startManualMode() {
            // ÏàòÎèô Î™®ÎìúÏóêÏÑúÎèÑ ÏûêÎèôÏ∞®Í∞Ä ÏïûÏúºÎ°ú Ïù¥Îèô
            gameInterval = setInterval(() => {
                carX += 1.5; // ÏàòÎèô Î™®ÎìúÎäî Ï°∞Í∏à ÎäêÎ¶¨Í≤å
                updateCarPosition();
            }, 50);
        }

        function endGame(success) {
            clearInterval(gameInterval);
            clearInterval(timeInterval);
            clearInterval(obstacleInterval);
            gameStarted = false;
            
            const resultDiv = document.getElementById('result');
            resultDiv.style.display = 'block';
            
            if (success) {
                resultDiv.className = 'result-message result-win';
                resultDiv.innerHTML = `üéâ Î™©Ìëú ÎèÑÎã¨ ÏÑ±Í≥µ!<br>ÏãúÍ∞Ñ: ${time}Ï¥à`;
            } else {
                resultDiv.className = 'result-message result-lose';
                resultDiv.innerHTML = `üí• Ï∂©ÎèåÎ°ú Í≤åÏûÑ Ï¢ÖÎ£å!<br>ÏãúÍ∞Ñ: ${time}Ï¥à`;
            }
        }

        function resetGame() {
            gameStarted = false;
            clearInterval(gameInterval);
            clearInterval(timeInterval);
            clearInterval(obstacleInterval);
            
            document.getElementById('startBtn').style.display = 'inline-block';
            document.getElementById('resetBtn').style.display = 'none';
            document.getElementById('gameArea').style.display = 'none';
            document.getElementById('laneIndicator').style.display = 'none';
            document.getElementById('result').style.display = 'none';
            
            // Ïû•Ïï†Î¨º Ï†úÍ±∞
            document.getElementById('obstacles').innerHTML = '';
            obstacles = [];
            
            carX = 30;
            currentLane = 1;
            progress = 0;
            time = 0;
        }

        // ÌÇ§Î≥¥Îìú Ïù¥Î≤§Ìä∏ (ÏàòÎèô Î™®ÎìúÏö©)
        document.addEventListener('keydown', (e) => {
            if (!gameStarted || selectedMode !== 'manual') return;
            
            if (e.key === 'a' || e.key === 'A') {
                if (currentLane > 0) {
                    changeLane(currentLane - 1);
                }
            } else if (e.key === 'd' || e.key === 'D') {
                if (currentLane < 2) {
                    changeLane(currentLane + 1);
                }
            }
        });

        // ÌÑ∞Ïπò Ïù¥Î≤§Ìä∏ (Î™®Î∞îÏùºÏö©)
        let touchStartX = 0;
        let touchEndX = 0;

        document.addEventListener('touchstart', (e) => {
            if (!gameStarted || selectedMode !== 'manual') return;
            touchStartX = e.changedTouches[0].screenX;
        });

        document.addEventListener('touchend', (e) => {
            if (!gameStarted || selectedMode !== 'manual') return;
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        });

        function handleSwipe() {
            if (Math.abs(touchStartX - touchEndX) > 50) {
                if (touchStartX > touchEndX && currentLane < 2) {
                    changeLane(currentLane + 1); // Ïò§Î•∏Ï™Ω Ïä§ÏôÄÏù¥ÌîÑ
                } else if (touchStartX < touchEndX && currentLane > 0) {
                    changeLane(currentLane - 1); // ÏôºÏ™Ω Ïä§ÏôÄÏù¥ÌîÑ
                }
            }
        }

        // Ïû•Ïï†Î¨º Ïù¥Îèô
        setInterval(() => {
            if (!gameStarted) return; // Í≤åÏûÑÏù¥ ÏãúÏûëÎêòÏßÄ ÏïäÏïòÏúºÎ©¥ Ïã§ÌñâÌïòÏßÄ ÏïäÏùå
            
            obstacles.forEach((obstacle, index) => {
                obstacle.x -= obstacle.speed;
                obstacle.element.style.left = obstacle.x + '%';
                
                // Ïû•Ïï†Î¨ºÏùò Ïã§Ï†ú ÌîΩÏÖÄ ÏúÑÏπò ÏóÖÎç∞Ïù¥Ìä∏
                const roadContainer = document.querySelector('.road-container');
                const roadWidth = roadContainer.offsetWidth;
                obstacle.pixelX = (obstacle.x / 100) * roadWidth;
                
                // ÌôîÎ©¥ Î∞ñÏúºÎ°ú ÎÇòÍ∞ÄÎ©¥ Ï†úÍ±∞
                if (obstacle.x < -10) {
                    obstacle.element.remove();
                    obstacles.splice(index, 1);
                }
            });
        }, 50);
    </script>
</body>
</html>
